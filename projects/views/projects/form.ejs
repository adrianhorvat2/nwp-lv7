<!DOCTYPE html>
<html>

<head>
  <title>
    <%= title %>
  </title>
  <link rel='stylesheet' href='/stylesheets/style.css' />
</head>

<body>
  <div class="container">
    <header>
      <h1>Evidencija projekata</h1>
      <nav>
        <a href="/projects">Svi projekti</a>
        <a href="/projects/my-projects">Moji projekti</a>
        <a href="/projects/my-memberships">Moje članstvo</a>
        <a href="/projects/archive">Arhiva</a>
        <a href="/projects/new" class="btn-primary">+ Novi projekt</a>
        <% if (user) { %>
          <div class="user-info">
            <strong>
              <%= user.name %>
            </strong> | <a href="/users/logout">Odjava</a>
          </div>
          <% } %>
      </nav>
    </header>

    <main>
      <h2>
        <%= title %>
      </h2>

      <form method="POST" action="<%= action %>" class="project-form">
        <div class="form-group">
          <label for="naziv">Naziv projekta *</label>
          <input type="text" id="naziv" name="naziv" value="<%= project ? project.naziv : '' %>" required>
        </div>

        <div class="form-group">
          <label for="opis">Opis projekta *</label>
          <textarea id="opis" name="opis" rows="4" required><%= project ? project.opis : '' %></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="cijena">Cijena (€) *</label>
            <input type="number" id="cijena" name="cijena" step="0.01" value="<%= project ? project.cijena : '' %>"
              required>
          </div>

          <div class="form-group">
            <label for="datumPocetka">Datum početka *</label>
            <input type="date" id="datumPocetka" name="datumPocetka" value="<%= project ? project.datumPocetka : '' %>"
              required>
          </div>

          <div class="form-group">
            <label for="datumZavrsetka">Datum završetka *</label>
            <input type="date" id="datumZavrsetka" name="datumZavrsetka"
              value="<%= project ? project.datumZavrsetka : '' %>" required>
          </div>
        </div>

        <div class="form-group">
          <label for="obavljeniPoslovi">Obavljeni poslovi</label>
          <textarea id="obavljeniPoslovi" name="obavljeniPoslovi"
            rows="3"><%= project ? project.obavljeniPoslovi : '' %></textarea>
        </div>

        <div class="form-group">
          <label>Članovi tima</label>
          <div class="team-member-selector">
            <% if (users && users.length> 0) { %>
              <% users.forEach(function(u) { %>
                <div class="team-member-item">
                  <input type="checkbox" id="user-<%= u.id %>" name="teamMembers" value="<%= u.id %>" <%=(project &&
                    project.teamMembers && project.teamMembers.includes(u.id)) ? 'checked' : '' %>
                  >
                  <label for="user-<%= u.id %>">
                    <%= u.name %> (<%= u.email %>)
                  </label>
                </div>
                <% }); %>
                  <% } else { %>
                    <p style="color: #999; font-size: 14px;">Nema dostupnih korisnika za dodavanje u tim</p>
                    <% } %>
          </div>
          <small>Odaberite korisnike koji će biti članovi tima</small>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary">Spremi</button>
          <a href="/projects" class="btn-secondary">Odustani</a>
        </div>
      </form>
    </main>
  </div>
</body>

</html>